<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <meta charset="utf-8" />
    <link href="jqwidgets/styles/jqx.base.css" rel="stylesheet" />
    <link href="jqwidgets/styles/jqx.orange.css" rel="stylesheet" />
    <link href="jqwidgets/styles/jqx.office.css" rel="stylesheet" />
    <link href="jqwidgets/styles/jqx.energyblue.css" rel="stylesheet" />
    <link href="jqwidgets/styles/jqx.energyblue2.css" rel="stylesheet" />
    <script type="text/javascript" src="scripts/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="scripts/json2.js"></script>
    <script src="jqwidgets/jqx-all.js"></script>
    <script src="Scripts/CryptoJS v3.1.2/rollups/aes.js"></script>
    <script src="component/csTabs.js"></script>
    <script src="component/csList.js"></script>
    <script src="component/csMulti.js"></script>
    <script src="component/csDateTime.js"></script>
    <script src="component/csUploadFile.js"></script>
    <script src="component/csAddress1.js"></script>
    <script src="component/csAddress2.js"></script>
    <script src="component/csWindow.js"></script>
    <script src="dynamicComponent/dynamicCondition.js"></script>
    <script src="dynamicComponent/dynamicConditionSave.js"></script>
    <script src="dynamicComponent/dynamicGrid.js"></script>
    <script src="dynamicComponent/dynUpdateGrid.js"></script>
    <script src="component/csUploadFile.js"></script>
    <script src="component/csDownloadFile.js"></script>
    <script src="dynamicComponent/dynLinkProgram.js"></script>
    <script src="dynamicComponent/showPreviousPara.js"></script>
    <script src="jqwidgets/globalization/globalize.js"></script>
    <script src="language/zh-TW/language01.js"></script>
    <script src="language/zh-TW/language21.js"></script>
    <script src="language/zh-TW/language31.js"></script>
    <script src="language/zh-TW/language51.js"></script>
    <script src="language/zh-TW/language52.js"></script>
    <script src="language/zh-TW/language61.js"></script>
    <script src="language/zh-TW/language71.js"></script>
    <script type="text/javascript" src="Utility/utility.js"></script>
    <style>
        * {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            font-size: 12px;
        }

        .jqx-widget, .jqx-widget-content, input[type=text].jqx-input, input[type=password].jqx-input {
            font-size: 12px;
        }

        input:focus {
            background: #E0E9F5;
        }

        textarea:focus {
            background: #E0E9F5;
        }

        .csslEditMode {
            background-color: #FFFF99;
            border-color: white;
        }
    </style>

    <script type="text/javascript">

        $(document).ready(function () {
            try {
                //$('div').browe()
                //var table = $('<table border="1" cellpadding="5" style="border:2px #26FF26 solid;text-align:center;"></table>').appendTo('body');
                //var tr = $('<tr></tr>').appendTo(table);
                //var td = $('<td></td><td></td>').appendTo(tr);
                //var tr = $('<tr></tr>').appendTo(table);
                //var td = $('<td colspan="2"></td>').appendTo(tr);
                ////$('<div>TEST</div>').appendTo(td);
                //return;
                //var x = messageBox("我是測試", messageType.yesnocancel, null, function (value) {
                //    alert(value);
                //});
                //var str = "12";
                //var regex = new RegExp("([0-1][0-9]|2[0-3])\:[0-5][0-9]");
                ////alert(str.match(regex));
                //alert(regex.test(str));
                //return;
                //return;
                //var data = [{ CODENO: 1, DESCRIPTION: 'TEST1' },
                //{ CODENO: 2, DESCRIPTION: 'TEST2' },
                //{ CODENO: 3, DESCRIPTION: 'TEST3' },
                //{ CODENO: 4, DESCRIPTION: 'TEST4' }];
                //$('#cslist2').csList2({
                //    source: data,
                //    theme: 'office'
                //});

                //$('#maindiv').each(function () {
                //    $.data(this, 'Button1', { test: { test1: 123, t2: 234 } });
                //});
                //$('#maindiv2').each(function () {
                //    $.data(this, 'Button1', { test: { test1: 123, t2: 2343333 } });
                //});
                //$('#maindiv').each(function () {
                //    alert(JSON.stringify( $.data(this, 'Button1')));
                //});
                
                var loginInfo = {
                    loginInfo: {
                        columns: [{ name: 'compcode', type: 'int' },
                            { name: 'entryid', type: 'str' },
                            { name: 'entryname', type: 'str' },
                            { name: 'groupid', type: 'str' }
                        ],
                        rows: [{
                            compcode: 3,
                            entryid: 'test',
                            entryname: 'test',
                            groupid: '50'
                        }]
                    }
                };

                var editmode = {
                    type: 'integer',
                    value: editMode.edit
                };
                /*
                var dsData = {
                    customer: {
                        columns: [{ name: 'custid', type: 'integer' },
                            { name: 'custname', type: 'string' },
                            { name: 'custidstr', type: 'string' },
                            { name: 'selectcondition', type: 'string' },
                            { name: 'faciseqno', type: 'string' },
                            { name: 'orderitem', type: 'integer' }
                        ],
                        rows: [{
                            custid: 600028,
                            custname: '無',
                            custidstr: '601005',
                            selectcondition: ' and custid > 601000 and custid < 601200',
                            faciseqno: '199902030169828',
                            orderitem: 1
                        }]
                    }
                }; */
                
                var dsData = {
                    CD001: {
                        columns: [{ name: 'CODENO', type: 'string' },
                            { name: 'DESCRIPTION', type: 'string' },
                            { name: 'REFNO', type: 'integer' },
                            { name: 'UPDTIME', type: 'string' },
                            { name: 'UPDEN', type: 'string' },
                            { name: 'COMPCODE', type: 'integer' },
                            { name: 'STOPFLAG', type: 'integer' },
                            { name: 'ZIPCODE', type: 'string' },
                            { name: 'CITYNAME', type: 'string' },
                            { name: 'EXTRAAREAFLAG', type: 'integer' },
                            { name: 'IMPORTFLAG', type: 'integer' },
                            { name: 'CACODE', type: 'integer' },
                            { name: 'NEWUPDTIME', type: 'date' }

                        ],
                        rows: [{
                            CODENO: 'X01',
                            DESCRIPTION: 'TEST',
                            REFNO: 1,
                            UPDTIME: '104/07/10 15:21:05',
                            UPDEN: 'Admin',
                            COMPCODE: 3,
                            STOPFLAG: 0,
                            ZIPCODE: '802',
                            CITYNAME: '1111',
                            EXTRAAREAFLAG: 0,
                            IMPORTFLAG: 0,
                            CACODE: null,
                            NEWUPDTIME: null,
                        }]
                    }
                }; 
                $('#Text1').val('SO3273A');
                $('#Text1').val('SO6310A');
                //if ($('#Text1').val().length == 0) {
                //}
                //var theme = 'orange';
                var params = getParameters('getKey', 'getKey', 'getKey', loginInfo);
                var initOk = (function (data) {
                    try {
                        $('[data-id=Button1]').on('click', function () {
                            //var programId = $('#Text1').val();
                            var programId = null;
                            var sysProgramId = $('#Text1').val();
                            var localization = Globalize('zh-TW');
                            var divName = 'div' + getUniqueId();
                            var div2Name = 'div2' + getUniqueId();

                            $('<div id="' + divName + '"><div>測試Form</div><div id="' + div2Name + '"></div></div>').appendTo('body');
                            var div = $('#' + divName);
                            $('#' + divName).csWindow($.extend({}, {
                                width: 1000,
                                height: 540,
                                minHeight: 200,
                                minWidth: 800,
                                maxWidth: $('document').innerWidth(),
                                maxHeight: $('document').innerHeight(),
                                resizable: true
                            }));

                            $('#' + div2Name).dynamicCondition($.extend({}, {
                                loginInfo: loginInfo,
                                container: $('#' + divName),                                                        
                                sysProgramId: sysProgramId,
                                parentData: dsData,
                                parameters: dsData,                                
                                localization: localization
                            }));
                            $('#' + divName).on('resized', function () {
                                //alert('resize');
                                //var height = $('#' + div2Name).height();
                                $('#' + div2Name).dynamicCondition('resize');
                                
                            });
                            $('#' + div2Name).on('loaded', function () {
                                $('#' + div2Name).dynamicCondition('resize');
                                //alert(1);
                                $(div).on('close', function (event) {
                                    $('#' + div2Name).dynamicCondition('destroy');
                                    $('#' + divName).csWindow('destroy');
                                });
                            });

                            $('#' + div2Name).on('valueChanging', function (event, args) {
                                //alert(JSON.stringify($(event.args.object).val()));
                                //alert(JSON.stringify(event.args));
                            });
                            $('#' + div2Name).on('valueChanged', function (event, args) {
                                //alert(JSON.stringify(event.args));
                            });
                            $('#' + divName).appendTo($($('body').find('[data-id=maindiv]')[0]));

                        });
                        $('[data-id=Button3]').on('click', function () {
                            if ($('#' + divName).csWindow('theme') == 'office') {
                                $('#' + divName).csWindow('theme', 'energyblue');
                                $('#' + div2Name).dynamicCondition('theme', 'energyblue');
                            }
                            else {
                                $('#' + divName).csWindow('theme', 'office');
                                $('#' + div2Name).dynamicCondition('theme', 'office');
                            }
                        });
                        $('[data-id=Button5]').on('click', function () {
                            var query = $('#' + div2Name).dynamicCondition('getQueryData', function (query) {
                                if (query[0] == true) {
                                    alert(JSON.stringify(query[2]));
                                }
                            });
                        });
                    }
                    catch (err) {
                        alert(err.stack);
                    }
                });
                //$(document).on('click', function () { alert('click');})

                getServerData(params, {
                    success: function (data) {
                        initOk(data);
                    },
                    error: function (d) {
                        messageBox(d);
                    }
                });

                //秀出form2 並傳參數
                $.jqx.theme = "energyblue2";

                //$('[data-id=Button4]').on('click', function () {
                //    $('#cslist2').csList2('destroy');

                //    //$('#cslist2').csList2('description', 2);
                //    //var x = $('#cslist2').csList2('checkDataOk');
                //    //$('#cslist2').csList2('clear');
                //    //alert(JSON.stringify(x));
                //});
                return;

                $('#input1').jqxInput({ height: 20, width: 580 });
                $('#maskInput1').jqxMaskedInput({
                    height: 20, width: 580, promptChar: ' ',
                    textAlign: "right"
                });
                $('#datetime1').jqxDateTimeInput({ height: 20, width: 580, showCalendarButton: false });
                $('#numberInput1').jqxNumberInput({ height: 20, width: 580 });
                $('#passwordInput1').jqxPasswordInput({ height: 20, width: 580 });

            }
            catch (err) {
                alert(err.stack);
            }
        });
    </script>
</head>
<body>
    <div id="maindiv">
        <input id="Text1" type="text" />
        <input data-id="Button1" type="button" value="Show Form" />
        <input data-id="Button2" type="button" value="Close Form" />
        <input data-id="Button3" type="button" value="Change Theme" />
        <input data-id="Button4" type="button" value="check Data Ok" />
        <input data-id="Button5" type="button" value="getQueryData" />
        <input id="files-upload" type="file" multiple>
    </div>
    <div id="cslist2" style="width:200px;">

    </div>
    <div id="maindiv2">
        <div>
            <div>
                datetime:
            </div>
            <input id="datetime1" />
        </div>
        <div>
            <div>
                maskInput:
            </div>
            <input id="maskInput1" />
        </div>
        <div>
            <div>
                input:
            </div>
            <input id="input1" type="password" />
        </div>
        <div>
            <div>
                numberInput:
            </div>
            <input id="numberInput1" />
        </div>
        <div>
            <div>
                passwordInput:
            </div>
            <input id="passwordInput1" type="password" />
        </div>
    </div>
</body>
</html>
